# 附錄C: 物聯網驗證要求

本章原本是在main分支中，但考慮到OWASP IoT團隊已完成的工作，所以在該主題上維護兩個不同的執行緒沒有意義。對於 4.0 版本，我們將其移到附錄中，並敦促所有需要此功能的人使用主要的 [OWASP IoT 專案](https://owasp.org/www-project-internet-of-things/)

## 控制目標

嵌入式/IoT裝置應該滿足：

* 通過在受信任的環境中實施安全控制，在裝置內擁有與伺服器中相同級別的安全控制。
* 儲存在裝置上的敏感資料，應使用硬體支援的儲存（如安全元件）以安全的方式完成。
* 從裝置傳輸的所有敏感資料，都應利用傳輸層安全。

## 安全驗證要求

| # | 說明 | L1 | L2 | L3 | 起始時間 |
| --- | --- | --- | --- | -- | -- |
| **C.1** | 驗證應用層除錯介面，如USB、UART和其他序列變體，是否被禁用或受到複雜密碼的保護。 | ✓ | ✓ | ✓ | 4.0 |
| **C.2** | 驗證加密金鑰和證書對於每個單獨的裝置都是唯一的。 | ✓ | ✓ | ✓ | 4.0 |
| **C.3** | 驗證嵌入式/IoT 作業系統（如果適用）是否啟用了記憶體保護控制（如 ASLR 和 DEP）。 | ✓ | ✓ | ✓ | 4.0 |
| **C.4** | 驗證是否禁用了 JTAG 或 SWD 等片上除錯介面，或者是否啟用並正確配置了可用的保護機制。 | ✓ | ✓ | ✓ | 4.0 |
| **C.5** | 驗證是否已實施並啟用受信任的執行（如果在裝置 SoC 或 CPU 上可用）。 | ✓ | ✓ | ✓ | 4.0 |
| **C.6** | 驗證敏感資料、私鑰和證書是否安全儲存在Secure Element、TPM、TEE (Trusted Execution Environment)中，或使用強加密保護。 | ✓ | ✓ | ✓ | 4.0 |
| **C.7** | 驗證韌體應用程式使用傳輸層安全，保護傳輸中的資料。 | ✓ | ✓ | ✓ | 4.0 |
| **C.8** | 驗證韌體應用程式驗證與伺服器連線的數字簽名。 | ✓ | ✓ | ✓ | 4.0 |
| **C.9** | 驗證無線通訊鑑權。 | ✓ | ✓ | ✓ | 4.0 |
| **C.10** | 驗證無線通訊是否通過加密通道傳送。 | ✓ | ✓ | ✓ | 4.0 |
| **C.11** | 驗證任何被禁止的C函式，都被替換成適當的安全函式。 | ✓ | ✓ | ✓ | 4.0 |
| **C.12** | 驗證每個韌體都有一個軟體材料清單，其中包括第三方元件、版本和已公佈的漏洞。 | ✓ | ✓ | ✓ | 4.0 |
| **C.13** | 驗證所有程式碼，包括第三方二進位制檔案、庫、框架都經過審查，以防止硬編碼憑據（後門）。 | ✓ | ✓ | ✓ | 4.0 |
| **C.14** | 通過呼叫shell命令封裝器、指令碼或安全控制，來防止作業系統命令注入，驗證應用程式和韌體元件不受作業系統命令注入的影響。 | ✓ | ✓ | ✓ | 4.0 |
| **C.15** | 驗證韌體應用程式將數字簽名固定到可信伺服器。 |  | ✓ | ✓ | 4.0 |
| **C.16** | 驗證是否存在防篡改或篡改檢測功能。 |  | ✓ | ✓ | 4.0 |
| **C.17** | 驗證是否啟用了晶片製造商提供的任何可用的智慧財產權保護技術。 |  | ✓ | ✓ | 4.0 |
| **C.18** | 驗證安全控制是否到位，以阻止韌體逆向工程（例如，刪除冗長的除錯符號）。 |  | ✓ | ✓ | 4.0 |
| **C.19** | 驗證裝置在載入前校驗啟動映象的簽名。 |  | ✓ | ✓ | 4.0 |
| **C.20** | 驗證韌體更新過程不會受到“檢查時間與使用時間”攻擊（譯者注：time-of-check vs time-of-use attacks）。 |  | ✓ | ✓ | 4.0 |
| **C.21** | 驗證裝置在安裝前使用程式碼簽名並校驗韌體升級檔案。 |  | ✓ | ✓ | 4.0 |
| **C.22** | 驗證裝置不能被降級到有效韌體的舊版本（防回滾）。 |  | ✓ | ✓ | 4.0 |
| **C.23** | 驗證嵌入式裝置使用了密碼學安全的偽隨機數生成器（例如，使用晶片提供的隨機數生成器）。 |  | ✓ | ✓ | 4.0 |
| **C.24** | 驗證韌體能夠按照預定的時間表，執行自動韌體更新。 |  | ✓ | ✓ | 4.0 |
| **C.25** | 驗證裝置在檢測到篡改或收到無效資訊時，能擦除韌體和敏感資料。 |  |  | ✓ | 4.0 |
| **C.26** | 驗證只使用了支援禁用除錯介面（如JTAG、SWD）的微控制器。 |  |  | ✓ | 4.0 |
| **C.27** | 驗證只使用了提供實質性保護的微控制器，以防止“去封裝”（譯者注：de-capping, decapsulation）和側通道攻擊。 |  |  | ✓ | 4.0 |
| **C.28** | 驗證敏感導線不暴露在印刷電路板的外層。 |  |  | ✓ | 4.0 |
| **C.29** | 驗證晶片間的通訊是加密的（如主機板到子板的通訊）。 |  |  | ✓ | 4.0 |
| **C.30** | 驗證裝置使用程式碼簽名並在執行前驗證程式碼。 |  |  | ✓ | 4.0 |
| **C.31** | 驗證儲存在記憶體中的敏感資訊一旦不再需要，就立即用零值覆蓋。 |  |  | ✓ | 4.0 |
| **C.32** | 驗證韌體應用程式利用核心容器在應用程式之間進行隔離。 |  |  | ✓ | 4.0 |
| **C.33** | 驗證安全編譯器標誌，例如 -fPIE, -fstack-protector-all, -Wl,-z,noexecstack, -Wl,-z,noexecheap 已配置到韌體構建中。 |  |  | ✓ | 4.0 |
| **C.34** | 驗證微型控制器是否配置了程式碼保護（如果適用）。 |  |  | ✓ | 4.0 |

## 參考文獻

有關更多資訊，請參閱：

* [OWASP Internet of Things Top 10](https://owasp.org/www-pdf-archive/OWASP-IoT-Top-10-2018-final.pdf)
* [OWASP Embedded Application Security Project](https://owasp.org/www-project-embedded-application-security/)
* [OWASP Internet of Things Project](https://owasp.org/www-project-internet-of-things/)
* [Trudy TCP Proxy Tool](https://github.com/praetorian-inc/trudy)
