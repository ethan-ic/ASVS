# V8 資料保護

## Control Objective

健全的資料保護有三個關鍵因素。機密性、完整性和可用性（CIA）。這個標準假定資料保護是在一個可信的系統上執行的，比如伺服器，它已經被加固並有足夠的保護措施。

應用程式必須假設所有的使用者裝置都以某種方式受到損害。如果應用程式在不安全的裝置上傳輸或儲存敏感資訊，如共享電腦、手機和平板電腦，應用程式有責任確保儲存在這些裝置上的資料是加密的，不能輕易地被非法獲取、改變或披露。

確保經過驗證的應用程式滿足以下高水平的資料保護要求：

* 機密性。資料應受到保護，在傳輸過程中和儲存時都不會被未經授權的觀察或披露。
* 完整性。應保護資料不被未經授權的攻擊者惡意建立、更改或刪除。
* 可用性。資料應按要求提供給授權的使用者。

## V8.1 通用資料保護

| # | 說明 | L1 | L2 | L3 | CWE |
| :---: | :--- | :---: | :---: | :---: | :---: |
| **8.1.1** | 驗證應用程式保護敏感資料不被快取在負載均衡和應用程式快取等伺服器元件中。 | | ✓ | ✓ | 524 |
| **8.1.2** | 驗證在伺服器上所儲存敏感資料的所有快取或臨時副本是否受到保護（防止未經授權的訪問），或在被授權使用者訪問後清除 / 失效。 | | ✓ | ✓ | 524 |
| **8.1.3** | 驗證應用程式儘量減少請求中的引數數量，如隱藏欄位、Ajax 變數、cookies 和請求頭。 | | ✓ | ✓ | 233 |
| **8.1.4** | 驗證應用程式能夠檢測並提醒異常的請求數量，例如按 IP、使用者、每小時或每天的總數，或其它對應用程式有意義的指標。 | | ✓ | ✓ | 770 |
| **8.1.5** | 驗證是否對重要資料進行了定期備份，是否對資料進行了測試恢復。 | | | ✓ | 19 |
| **8.1.6** | 驗證備份的安全儲存，防止資料被盜或損壞。 | | | ✓ | 19 |

## V8.2 客戶端資料保護

| # | 說明 | L1 | L2 | L3 | CWE |
| :---: | :--- | :---: | :---: | :---: | :---: |
| **8.2.1** | 驗證應用程式設定足夠的 “禁止快取” 頭，以便敏感資料不會在現代瀏覽器中被快取。 | ✓ | ✓ | ✓ | 525 |
| **8.2.2** | 驗證儲存在瀏覽器儲存（例如 localStorage、sessionStorage、IndexedDB 或 cookie）中的資料不包含敏感資料。 | ✓ | ✓ | ✓ | 922 |
| **8.2.3** | 在客戶端或會話終止後，驗證經過身份驗證的資料已從客戶端儲存（例如瀏覽器 DOM）中清除。 | ✓ | ✓ | ✓ | 922 |

## V8.3 敏感私有資料

本小節有助於保護敏感資料免遭未經授權的建立、讀取、更新或刪除，尤其是批量資料。

遵守本節意味著遵守 V4 訪問控制，尤其是 V4.2。例如，為了防止個人敏感資訊的未授權的更新或洩露，需要遵守 V4.2.1。請遵守本節和 V4 以獲得全面覆蓋。

注意：隱私法規和法律，例如澳大利亞隱私原則 APP-11 或 GDPR，直接影響應用程式必須如何處理敏感個人資訊的儲存、使用和傳輸的實施。範圍從嚴厲的處罰到簡單的建議。請查閱您當地的法律法規，並根據需要諮詢專業的隱私專家或律師。

| # | 說明 | L1 | L2 | L3 | CWE |
| :---: | :--- | :---: | :---: | :---: | :---: |
| **8.3.1** | 驗證敏感資料是在 HTTP 訊息正文或請求頭中被髮送到伺服器，以及 HTTP 請求方法的查詢字串引數都不包含敏感資料。 | ✓ | ✓ | ✓ | 319 |
| **8.3.2** | 驗證使用者是否有途徑按需刪除或匯出自己的資料。 | ✓ | ✓ | ✓ | 212 |
| **8.3.3** | 驗證向用戶提供了關於收集和使用其個人資訊的明確語言，並且在以任何方式使用這些資料之前，使用者已勾選了同意。 | ✓ | ✓ | ✓ | 285 |
| **8.3.4** | 驗證應用程式建立和處理的所有敏感資料是否已被識別，並確保已制定瞭如何處理敏感資料的策略。 ([C8](https://owasp.org/www-project-proactive-controls/#div-numbering)) | ✓ | ✓ | ✓ | 200 |
| **8.3.5** | 如果資料是根據相關資料保護指令收集的或（應用）要求記錄訪問日誌，驗證訪問敏感資料是否被審計（不記錄敏感資料本身）。 | | ✓ | ✓ | 532 |
| **8.3.6** | 為了減少記憶體轉儲攻擊，一旦不再需要記憶體中的敏感資訊，請檢查該敏感資訊是否會被覆蓋（使用 0 或隨機數）。 | | ✓ | ✓ | 226 |
| **8.3.7** | 驗證需要加密的敏感資訊或私有資訊是否使用經過批准的機密性和完整性演算法加密。 ([C8](https://owasp.org/www-project-proactive-controls/#div-numbering)) | | ✓ | ✓ | 327 |
| **8.3.8** | 驗證敏感的個人資訊是否符合資料保留分類，以便自動、按計劃或根據情況需要刪除舊資料或過時資料。 | | ✓ | ✓ | 285 |

在考慮資料保護時，首要的考慮應該圍繞批量提取、修改或過度使用。例如，許多社交媒體系統只允許使用者每天新增 100 個新好友，但這些請求來自哪個系統並不重要。銀行平臺可能希望阻止每小時超過 5 筆的、轉移超過 1000 歐元的外部交易。每個系統的要求可能非常不同，所以決定 “異常” 必須考慮威脅模型和商業風險。重要的標準是檢測、遏制，或者最好是阻止這種異常批量行為的能力。

## 參考文獻

有關更多資訊，請參閱：

* [Consider using Security Headers website to check security and anti-caching headers](https://securityheaders.io)
* [OWASP Secure Headers project](https://owasp.org/www-project-secure-headers/)
* [OWASP Privacy Risks Project](https://owasp.org/www-project-top-10-privacy-risks/)
* [OWASP User Privacy Protection Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/User_Privacy_Protection_Cheat_Sheet.html)
* [European Union General Data Protection Regulation (GDPR) overview](https://edps.europa.eu/data-protection_en)
* [European Union Data Protection Supervisor - Internet Privacy Engineering Network](https://edps.europa.eu/data-protection/ipen-internet-privacy-engineering-network_en)